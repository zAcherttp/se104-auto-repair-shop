ID,Test Case Description,Test Case Procedure,Expected Output,Inter-test case Dependence,Result,Test date,Note
RLS-1,Multi-tenant data isolation,Create 2 garages with users → Create vehicles/orders for each → Query by user,Users only see their garage's data,None,Pass,2025-12-16,From security/rls.test.ts
RLS-2,Isolate customer data by garage,Create 2 users → Create customer for each → Query by user context,Each user sees only their customers,None,Pass,2025-12-16,From security/rls.test.ts
RLS-3,Require valid user for repair orders,Create vehicle → Try insert order with non-existent user_id,Insert rejected (FK violation 23503),None,Pass,2025-12-16,From security/rls.test.ts
RLS-4,Require valid user for payments,Create vehicle → Try insert payment with non-existent user_id,Insert rejected (FK violation 23503),None,Pass,2025-12-16,From security/rls.test.ts
RLS-5,Identify admin via metadata,Create admin and employee users → Check isGarageAdmin flag,"Admin=true, Employee=false",None,Pass,2025-12-16,From security/rls.test.ts
RLS-6,Both roles create repair orders,Create admin and employee → Each creates order → Verify both succeed,Both orders created successfully,None,Pass,2025-12-16,From security/rls.test.ts
RLS-7,Users access own created records,Create user → Create order as user → Query by created_by,User sees own records,None,Pass,2025-12-16,From security/rls.test.ts
RLS-8,Referential integrity across tables,"Create user, vehicle, order, payment → Query with joins",All relationships maintained correctly,None,Pass,2025-12-16,From security/rls.test.ts
RLS-9,Profile created with user,Create new user → Query profiles table,Profile exists with same user.id,None,Pass,2025-12-16,From security/rls.test.ts
RLS-10,Admin status in user metadata,Create admin and employee → Check metadata,isGarageAdmin stored correctly,None,Pass,2025-12-16,From security/rls.test.ts
RLS-11,Prevent cross-employee profile edits,Create 2 employees → Try update other's profile,Update rejected (insufficient_privilege 42501),None,Expected Fail,2025-12-16,Spec for RLS profile policy
RLS-12,Cascade delete user data,"Create user with profile, orders, payments → Delete user",Related data cascaded or set NULL,None,Expected Fail,2025-12-16,Spec for cascade delete trigger